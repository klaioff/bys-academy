<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BYS Academy - Boost Your Skills</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #0f172a 100%);
            min-height: 100vh;
        }
        
        /* Palette de couleurs des logos */
        :root {
            --ihec-blue: #1e3a8a;
            --ihec-dark: #0f172a;
            --hecfa-yellow: #ffd700;
            --hecfa-blue: #1e40af;
        }
        
        /* Mobile optimizations */
        html {
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
        }
        
        * {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            padding: 0.8rem 1rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: none;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            flex-wrap: wrap;
        }
        .navbar.show { display: flex; }
        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--ihec-blue);
        }
        .logo-container {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .logo-ihec, .logo-hecfa {
            height: 40px;
            width: auto;
        }
        .logo span {
            display: none;
        }
        .nav-links {
            display: none;
            width: 100%;
            flex-direction: column;
            gap: 0;
            list-style: none;
            background: white;
            position: absolute;
            top: 100%;
            left: 0;
            box-shadow: 0 5px 10px rgba(0,0,0,0.1);
        }
        .nav-links.mobile-open {
            display: flex;
        }
        .nav-links li {
            border-bottom: 1px solid #f0f0f0;
        }
        .nav-links a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s;
            cursor: pointer;
            display: block;
            padding: 1rem 1.5rem;
        }
        .nav-links a:hover { 
            color: var(--ihec-blue);
            background: #f8f9fa;
        }
        
        /* Hamburger Menu */
        .menu-toggle {
            display: block;
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
            position: relative;
            width: 30px;
            height: 30px;
            z-index: 1001;
        }
        .menu-toggle span {
            display: block;
            width: 25px;
            height: 3px;
            background: white;
            margin: 5px 0;
            transition: all 0.3s ease;
            border-radius: 2px;
        }
        .menu-toggle.active span:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }
        .menu-toggle.active span:nth-child(2) {
            opacity: 0;
        }
        .menu-toggle.active span:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -7px);
        }
        .user-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }
        .user-info span {
            display: none;
        }
        .btn-logout {
            background: var(--ihec-blue);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 500;
            font-size: 0.9rem;
            transition: background 0.3s;
        }
        .btn-logout:hover { background: var(--ihec-dark); }
        .container {
            max-width: 1200px;
            margin: 1rem auto;
            padding: 0 1rem;
        }
        .page {
            display: none;
            animation: fadeIn 0.5s;
        }
        .page.active { display: block; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .auth-container {
            max-width: 450px;
            margin: 2rem auto;
            background: white;
            padding: 2rem 1.5rem;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .auth-container h2 {
            text-align: center;
            color: #333;
            margin-bottom: 0.5rem;
            font-size: 1.5rem;
        }
        .auth-container p {
            text-align: center;
            color: #666;
            margin-bottom: 2rem;
        }
        .form-group {
            margin-bottom: 1.5rem;
        }
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #333;
            font-weight: 500;
        }
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            transition: border 0.3s;
            font-family: inherit;
        }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--ihec-blue);
        }
        .btn-primary {
            width: 100%;
            background: linear-gradient(135deg, var(--ihec-blue) 0%, var(--hecfa-blue) 100%);
            color: white;
            border: none;
            padding: 1rem;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-primary:hover { 
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(30, 58, 138, 0.3);
        }
        .btn-primary:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .auth-link {
            text-align: center;
            margin-top: 1rem;
            color: #666;
        }
        .auth-link a {
            color: var(--ihec-blue);
            text-decoration: none;
            font-weight: 600;
            cursor: pointer;
        }
        .auth-link a:hover {
            color: var(--hecfa-yellow);
        }
        .btn-guest {
            width: 100%;
            background: transparent;
            color: var(--ihec-blue);
            border: 2px solid var(--ihec-blue);
            padding: 1rem;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 1rem;
        }
        .btn-guest:hover {
            background: var(--ihec-blue);
            color: white;
            transform: translateY(-2px);
        }
        .divider {
            display: flex;
            align-items: center;
            text-align: center;
            margin: 1.5rem 0;
            color: #999;
        }
        .divider::before,
        .divider::after {
            content: '';
            flex: 1;
            border-bottom: 1px solid #e0e0e0;
        }
        .divider span {
            padding: 0 1rem;
            font-size: 0.9rem;
        }
        .error-message, .success-message {
            padding: 0.8rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: none;
        }
        .error-message {
            background: #ff4444;
            color: white;
        }
        .success-message {
            background: #4caf50;
            color: white;
        }
        .hero {
            background: white;
            border-radius: 15px;
            padding: 2rem 1.5rem;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 2rem;
        }
        .hero h1 {
            font-size: 1.8rem;
            color: #333;
            margin-bottom: 1rem;
        }
        .hero p {
            font-size: 1rem;
            color: #666;
            margin-bottom: 0.8rem;
        }
        .features {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }
        .feature-card {
            background: white;
            padding: 1.5rem;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        .feature-card:hover { transform: translateY(-5px); }
        .feature-card h3 {
            color: var(--ihec-blue);
            margin-bottom: 0.8rem;
            font-size: 1.3rem;
        }
        .feature-card p {
            line-height: 1.6;
        }
        .feature-card:nth-child(2) h3 {
            color: var(--hecfa-yellow);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        .feature-card:nth-child(3) h3 {
            color: var(--hecfa-blue);
        }
        .card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 1.5rem;
        }
        .card h2 {
            font-size: 1.5rem;
            margin-bottom: 0.8rem;
        }
        .formations-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }
        .formation-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        .formation-card:hover { transform: translateY(-5px); }
        .formation-body {
            padding: 1.5rem;
        }
        .formation-body h3 {
            color: #333;
            margin-bottom: 0.5rem;
        }
        .learning-interface {
            display: flex;
            height: calc(100vh - 70px);
        }
        .course-sidebar {
            width: 400px;
            background: white;
            border-right: 1px solid #eee;
            overflow-y: auto;
            padding: 1rem;
        }
        .course-content {
            flex: 1;
            background: #f8f9fa;
            overflow-y: auto;
            padding: 2rem;
        }
        .module-item {
            padding: 1rem;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            gap: 1rem;
            cursor: pointer;
            transition: background 0.3s;
        }
        .module-item:hover {
            background: #f8f9fa;
        }
        .module-item.active {
            background: var(--ihec-blue);
            color: white;
        }
        .module-item .duration {
            font-size: 0.9rem;
            color: #666;
        }
        .module-item.active .duration {
            color: #fff;
        }
        .video-container {
            background: black;
            aspect-ratio: 16/9;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
        }
        .learning-tabs {
            display: flex;
            gap: 2rem;
            margin-bottom: 2rem;
            border-bottom: 1px solid #eee;
            padding-bottom: 1rem;
        }
        .learning-tab {
            color: #666;
            cursor: pointer;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            transition: all 0.3s;
        }
        .learning-tab:hover {
            background: #f0f0f0;
        }
        .learning-tab.active {
            color: var(--ihec-blue);
            background: #f0f0f0;
        }
        .discussion-actions {
            display: flex;
            gap: 1rem;
            margin-top: 0.5rem;
        }
        .action-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #666;
            cursor: pointer;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        .action-btn:hover {
            background: #f0f0f0;
        }
        .replies-container {
            margin-left: 2rem;
            margin-top: 1rem;
            border-left: 2px solid #eee;
            padding-left: 1rem;
        }
        .btn-secondary {
            background: var(--ihec-blue);
            color: white;
            border: none;
            padding: 0.6rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.3s;
        }
        .btn-secondary:hover:not(:disabled) { background: var(--hecfa-blue); }
        .btn-secondary:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .discussion-item {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 1rem;
        }
        .discussion-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }
        .discussion-author {
            font-weight: 600;
            color: var(--ihec-blue);
        }
        .discussion-date {
            color: #999;
            font-size: 0.9rem;
        }
        .loading {
            text-align: center;
            padding: 2rem;
            color: #666;
        }
        /* Footer styles */
        .footer {
            background: linear-gradient(135deg, var(--ihec-dark) 0%, var(--ihec-blue) 100%);
            color: white;
            padding: 2rem 0 1rem 0;
            margin-top: 2rem;
        }
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
        }
        .footer-section h3 {
            color: var(--hecfa-yellow);
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }
        .footer-section p, .footer-section a {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.8;
            text-decoration: none;
            display: block;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }
        .footer-section a:hover {
            color: var(--hecfa-yellow);
        }
        .social-links {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        .social-links a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            transition: all 0.3s;
        }
        .social-links a:hover {
            background: var(--hecfa-yellow);
            transform: translateY(-3px);
        }
        .footer-bottom {
            text-align: center;
            padding: 1.5rem 0;
            margin-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.6);
        }
        
        /* Progress Tracker */
        .progress-tracker {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 1.5rem;
        }
        .progress-tracker h2 {
            font-size: 1.3rem;
        }
        .progress-bar-container {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin: 1rem 0;
        }
        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--ihec-blue), var(--hecfa-yellow));
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }
        .stat-card {
            text-align: center;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 10px;
        }
        .stat-number {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--ihec-blue);
        }
        .stat-label {
            color: #666;
            font-size: 0.85rem;
        }
        
        /* Gamification Badges */
        .badges-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }
        .badge {
            text-align: center;
            padding: 1rem;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        .badge:hover {
            transform: scale(1.05);
        }
        .badge-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }
        .badge.locked {
            opacity: 0.4;
            filter: grayscale(100%);
        }
        .badge-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--ihec-blue);
        }
        .badge small {
            font-size: 0.75rem;
            color: #666;
        }
        
        /* Quiz System */
        .quiz-container {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .quiz-question {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 1.5rem;
        }
        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .quiz-option {
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .quiz-option:hover {
            border-color: var(--ihec-blue);
            background: #f8f9fa;
        }
        .quiz-option.selected {
            border-color: var(--ihec-blue);
            background: rgba(30, 58, 138, 0.1);
        }
        .quiz-option.correct {
            border-color: #4caf50;
            background: rgba(76, 175, 80, 0.1);
        }
        .quiz-option.incorrect {
            border-color: #f44336;
            background: rgba(244, 67, 54, 0.1);
        }
        
        /* Survey Styles */
        .survey-options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            margin-top: 2rem;
        }
        .survey-btn {
            background: white;
            border: 3px solid #e0e0e0;
            border-radius: 15px;
            padding: 2rem;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        .survey-btn:hover {
            border-color: var(--ihec-blue);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        .survey-btn h3 {
            margin: 1rem 0 0.5rem 0;
            color: var(--ihec-blue);
            font-size: 1.5rem;
        }
        .survey-btn p {
            color: #666;
            margin: 0;
        }

        /* Landing Page Styles */
        .landing-hero {
            text-align: center;
            padding: 3rem 1.5rem;
            background: linear-gradient(135deg, var(--ihec-blue), var(--hecfa-blue));
            color: white;
            border-radius: 20px;
            margin-bottom: 2rem;
        }
        .landing-hero h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        .hero-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        .landing-section {
            background: white;
            padding: 2rem 1.5rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .landing-section h2 {
            text-align: center;
            color: var(--ihec-blue);
            margin-bottom: 2rem;
            font-size: 2rem;
        }
        .certificate-showcase {
            text-align: center;
        }
        .testimonials {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }
        .testimonial-card {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 10px;
            border-left: 4px solid var(--hecfa-yellow);
        }
        .testimonial-text {
            font-style: italic;
            color: #555;
            margin-bottom: 1rem;
            line-height: 1.6;
        }
        .testimonial-author {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        .testimonial-author strong {
            color: var(--ihec-blue);
            font-size: 1.1rem;
        }
        .testimonial-author span {
            color: #888;
            font-size: 0.9rem;
        }
        .objectives-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }
        .objective-card {
            text-align: center;
            padding: 2rem 1.5rem;
            background: #f8f9fa;
            border-radius: 10px;
            transition: transform 0.3s;
        }
        .objective-card:hover {
            transform: translateY(-5px);
        }
        .objective-icon {
            font-size: 3rem;
            display: block;
            margin-bottom: 1rem;
        }
        .objective-card h3 {
            color: var(--ihec-blue);
            margin-bottom: 0.5rem;
        }
        .objective-card p {
            color: #666;
            line-height: 1.6;
        }

        /* Chat Widget */
        .chat-widget {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 9999;
        }
        .chat-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--ihec-blue), var(--hecfa-blue));
            color: white;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: transform 0.3s;
        }
        .chat-button:hover {
            transform: scale(1.1);
        }
        .chat-box {
            display: none;
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 350px;
            max-height: 500px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .chat-box.open {
            display: flex;
            flex-direction: column;
        }
        .chat-header {
            background: linear-gradient(135deg, var(--ihec-blue), var(--hecfa-blue));
            color: white;
            padding: 1rem;
            font-weight: 600;
        }
        .chat-messages {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            max-height: 300px;
        }
        .chat-message {
            background: #f0f0f0;
            padding: 0.75rem;
            border-radius: 10px;
            margin-bottom: 0.5rem;
        }
        .chat-message.admin {
            background: #e3f2fd;
        }
        .chat-input-area {
            padding: 1rem;
            border-top: 1px solid #e0e0e0;
            display: flex;
            gap: 0.5rem;
        }
        .chat-input {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 20px;
            outline: none;
        }
        .chat-send-btn {
            background: var(--ihec-blue);
            color: white;
            border: none;
            padding: 0.75rem 1.25rem;
            border-radius: 20px;
            cursor: pointer;
        }

        /* Leaderboard */
        
        /* Study Timer */
        .study-timer {
            background: linear-gradient(135deg, var(--ihec-blue), var(--hecfa-blue));
            color: white;
            border-radius: 15px;
            padding: 2rem 1rem;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .study-timer h2 {
            font-size: 1.3rem;
        }
        .timer-display {
            font-size: 3rem;
            font-weight: bold;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
        }
        .timer-controls {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            justify-content: center;
            margin-top: 1rem;
        }
        .timer-btn {
            padding: 0.8rem 1.5rem;
            border: 2px solid white;
            background: transparent;
            color: white;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 1rem;
        }
        .timer-btn:hover {
            background: white;
            color: var(--ihec-blue);
        }
        
        /* Profile Styles */
        .profile-section {
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid #e0e0e0;
        }
        .profile-section:last-child {
            border-bottom: none;
        }
        .profile-section h3 {
            color: var(--ihec-blue);
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }
        .profile-info {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }
        .info-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .info-item strong {
            color: #333;
        }
        .info-item span {
            color: #666;
        }

        /* Admin Styles */
        .admin-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 10px;
        }
        .admin-section h3 {
            color: var(--ihec-blue);
            margin-bottom: 1rem;
        }
        .requests-list {
            max-height: 400px;
            overflow-y: auto;
        }
        .request-item {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            border-left: 4px solid var(--hecfa-yellow);
        }
        .request-item strong {
            color: var(--ihec-blue);
        }
        
        /* Certificate Preview */
        .certificate-preview {
            background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
            border: 10px solid var(--hecfa-yellow);
            border-radius: 10px;
            padding: 3rem;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .certificate-title {
            font-size: 2.5rem;
            color: var(--ihec-blue);
            font-weight: bold;
            margin-bottom: 1rem;
        }
        .certificate-text {
            font-size: 1.2rem;
            color: #666;
            margin: 1rem 0;
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }
        .modal.active {
            display: flex;
        }
        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            max-width: 100%;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }
        .modal-content h2 {
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }
        .modal-content h3 {
            font-size: 1.1rem;
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
        }
        .modal-close {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            font-size: 1.8rem;
            cursor: pointer;
            color: #999;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-close:hover {
            color: #333;
        }
        
        @media (max-width: 768px) {
            body {
                font-size: 14px;
            }
            .learning-interface {
                flex-direction: column;
                height: auto;
            }
            .course-sidebar {
                width: 100%;
                max-height: 300px;
            }
            .course-content {
                padding: 1rem;
            }
            .discussion-actions {
                flex-wrap: wrap;
            }
            .btn-primary, .btn-secondary {
                font-size: 1rem;
                padding: 0.8rem 1.2rem;
            }
            .leaderboard-item {
                font-size: 0.9rem;
            }
            .leaderboard-rank {
                font-size: 1.2rem;
                width: 40px;
            }
            .social-links a {
                width: 35px;
                height: 35px;
            }
            .certificate-preview {
                padding: 2rem 1rem;
            }
            .certificate-title {
                font-size: 1.8rem;
            }
        }
        
        @media (min-width: 769px) {
            .logo span {
                display: inline;
            }
            .user-info span {
                display: inline;
            }
            .menu-toggle {
                display: none;
            }
            .nav-links {
                display: flex;
                position: static;
                width: auto;
                flex-direction: row;
                gap: 2rem;
                box-shadow: none;
            }
            .nav-links li {
                border: none;
            }
            .nav-links a {
                padding: 0;
            }
            .navbar {
                padding: 1rem 2rem;
            }
            .container {
                padding: 0 2rem;
                margin: 2rem auto;
            }
            .hero {
                padding: 4rem 3rem;
            }
            .hero h1 {
                font-size: 3rem;
            }
            .features {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 2rem;
            }
            .formations-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                gap: 2rem;
            }
            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            .badges-container {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }
            .timer-controls {
                flex-direction: row;
                gap: 1rem;
            }
            .timer-display {
                font-size: 4rem;
            }
            .footer-content {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                padding: 0 2rem;
            }
            .modal-content {
                max-width: 800px;
                padding: 2rem;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar" id="navbar">
        <div class="logo">
            <h2>üéì BYS Academy</h2>
        </div>
        <button class="menu-toggle" id="menuToggle">
            <span></span>
            <span></span>
            <span></span>
        </button>
        <ul class="nav-links" id="navLinks">
            <li><a id="navHome">üè† Accueil</a></li>
            <li><a id="navFormations">üìö Formations</a></li>
            <li><a id="navProfil">üë§ Profil</a></li>
        </ul>
        <div class="user-info">
            <span id="username"></span>
            <button class="btn-logout" id="logoutBtn">D√©connexion</button>
        </div>
    </nav>

    <div class="container">
        <!-- SONDAGE INITIAL -->
        <div id="survey" class="page active">
            <div class="auth-container">
                <h2>üéØ Bienvenue sur BYS Academy</h2>
                <p style="color: #666; margin-bottom: 2rem;">Pour mieux vous servir, quel domaine vous int√©resse le plus ?</p>
                <div class="survey-options">
                    <button class="survey-btn" onclick="selectInterest('IT')">
                        <span style="font-size: 3rem;">üíª</span>
                        <h3>IT</h3>
                        <p>Informatique & Technologies</p>
                    </button>
                    <button class="survey-btn" onclick="selectInterest('Finance')">
                        <span style="font-size: 3rem;">üí∞</span>
                        <h3>Finance</h3>
                        <p>Finance & Comptabilit√©</p>
                    </button>
                    <button class="survey-btn" onclick="selectInterest('Soft Skills')">
                        <span style="font-size: 3rem;">üéØ</span>
                        <h3>Soft Skills</h3>
                        <p>Communication & Leadership</p>
                    </button>
                </div>
            </div>
        </div>

        <!-- PAGE HOME (Landing Page) -->
        <div id="landing" class="page">
            <div class="landing-hero">
                <h1>üéì Bienvenue sur BYS Academy</h1>
                <p class="hero-subtitle">Boost Your Skills - Let's build together!</p>
            </div>

            <!-- Section Certificats -->
            <section class="landing-section">
                <div class="certificate-showcase">
                    <img src="images/certificate.jpg" alt="Certificats BYS Academy" style="max-width: 100%; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
                </div>
            </section>

            <!-- Section T√©moignages -->
            <section class="landing-section">
                <h2>üí¨ Ce que disent nos professeurs</h2>
                <div class="testimonials">
                    <div class="testimonial-card">
                        <p class="testimonial-text">"BYS Academy est une excellente initiative pour accompagner nos √©tudiants dans leur d√©veloppement professionnel."</p>
                        <div class="testimonial-author">
                            <strong>Dr. Ahmed Mansour</strong>
                            <span>Professeur de Finance - IHEC Carthage</span>
                        </div>
                    </div>
                    <div class="testimonial-card">
                        <p class="testimonial-text">"Une plateforme innovante qui r√©pond aux besoins de formation continue de nos √©tudiants."</p>
                        <div class="testimonial-author">
                            <strong>Dr. Fatma Trabelsi</strong>
                            <span>Professeur d'√âconomie - IHEC Carthage</span>
                        </div>
                    </div>
                    <div class="testimonial-card">
                        <p class="testimonial-text">"Je recommande vivement BYS Academy pour sa qualit√© p√©dagogique et son approche moderne."</p>
                        <div class="testimonial-author">
                            <strong>Dr. Mohamed Gharbi</strong>
                            <span>Professeur de Management - IHEC Carthage</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section Objectifs -->
            <section class="landing-section objectives">
                <h2>üéØ Nos Objectifs</h2>
                <div class="objectives-grid">
                    <div class="objective-card">
                        <span class="objective-icon">üìö</span>
                        <h3>Formation Continue</h3>
                        <p>Offrir des formations de qualit√© adapt√©es aux besoins du march√©</p>
                    </div>
                    <div class="objective-card">
                        <span class="objective-icon">ü§ù</span>
                        <h3>Communaut√©</h3>
                        <p>Cr√©er un espace d'√©change entre √©tudiants et professionnels</p>
                    </div>
                    <div class="objective-card">
                        <span class="objective-icon">üèÜ</span>
                        <h3>Excellence</h3>
                        <p>Accompagner chaque √©tudiant vers la r√©ussite professionnelle</p>
                    </div>
                    <div class="objective-card">
                        <span class="objective-icon">üöÄ</span>
                        <h3>Innovation</h3>
                        <p>Utiliser les meilleures technologies pour l'apprentissage</p>
                    </div>
                </div>
            </section>

            <!-- Bouton S'inscrire -->
            <div style="text-align: center; padding: 3rem 0;">
                <button class="btn-primary" style="padding: 1rem 3rem; font-size: 1.2rem;" onclick="showPage('register')">
                    üìù S'inscrire Maintenant
                </button>
                <p style="margin-top: 1rem; color: #666;">
                    D√©j√† membre ? <a href="#" onclick="showPage('login'); return false;" style="color: var(--ihec-blue); font-weight: 600;">Se connecter</a>
                </p>
            </div>
        </div>

        <div id="login" class="page">
            <div class="auth-container">
                <div style="display: flex; justify-content: center; align-items: center; gap: 1.5rem; margin-bottom: 1.5rem;">
                    <svg style="height: 70px; width: auto;" viewBox="0 0 200 280" xmlns="http://www.w3.org/2000/svg">
                        <rect fill="#1e3a8a" width="200" height="280"/>
                        <g transform="translate(100, 90)">
                            <rect fill="#ffffff" x="-3" y="0" width="6" height="75" rx="1.5"/>
                            <path fill="none" stroke="#ffffff" stroke-width="2.5" d="M -3,15 Q -18,25 -14,40 Q -10,50 -3,58"/>
                            <path fill="none" stroke="#ffffff" stroke-width="2.5" d="M 3,15 Q 18,25 14,40 Q 10,50 3,58"/>
                            <circle fill="#ffffff" cx="-14" cy="20" r="2"/>
                            <circle fill="#ffffff" cx="14" cy="20" r="2"/>
                            <path fill="#ffffff" d="M -3,-8 Q -28,-15 -32,-8 Q -35,-2 -30,3 Q -25,6 -3,2 Z"/>
                            <path fill="#ffffff" d="M 3,-8 Q 28,-15 32,-8 Q 35,-2 30,3 Q 25,6 3,2 Z"/>
                        </g>
                        <ellipse cx="100" cy="130" rx="48" ry="52" fill="none" stroke="#ffffff" stroke-width="2.5"/>
                        <text fill="#ffffff" x="100" y="210" font-family="serif" font-size="38" font-weight="bold" text-anchor="middle">IHEC</text>
                        <text fill="#ffffff" x="100" y="238" font-family="serif" font-size="16" text-anchor="middle" letter-spacing="6">CARTHAGE</text>
                    </svg>
                    
                    <svg style="height: 70px; width: auto;" viewBox="0 0 220 220" xmlns="http://www.w3.org/2000/svg">
                        <g transform="translate(110, 65)">
                            <ellipse fill="#ffd700" cx="0" cy="18" rx="32" ry="22"/>
                            <ellipse fill="#ffd700" cx="0" cy="-3" rx="18" ry="16"/>
                            <path fill="#ffd700" d="M -14,-14 Q -23,-22 -19,-26 Q -17,-24 -14,-18 Z"/>
                            <path fill="#ffd700" d="M 14,-14 Q 23,-22 19,-26 Q 17,-24 14,-18 Z"/>
                            <rect fill="#ffd700" x="-22" y="32" width="7" height="18" rx="2"/>
                            <rect fill="#ffd700" x="-7" y="32" width="7" height="18" rx="2"/>
                            <rect fill="#ffd700" x="0" y="32" width="7" height="18" rx="2"/>
                            <rect fill="#ffd700" x="15" y="32" width="7" height="18" rx="2"/>
                            <circle cx="-7" cy="-3" r="1.8" fill="#1e40af"/>
                            <circle cx="7" cy="-3" r="1.8" fill="#1e40af"/>
                        </g>
                        <g transform="translate(110, 108)">
                            <ellipse fill="#1e40af" cx="0" cy="2" rx="26" ry="16" opacity="0.75"/>
                            <circle fill="#1e40af" cx="0" cy="-12" r="13" opacity="0.75"/>
                        </g>
                        <text x="110" y="165" font-family="'Arial Black', sans-serif" font-size="36" font-weight="900" text-anchor="middle">
                            <tspan fill="#1e40af">HEC'</tspan><tspan fill="#ffd700">FA</tspan>
                        </text>
                        <text fill="#1e40af" x="110" y="185" font-family="Arial" font-size="12" text-anchor="middle" letter-spacing="1.5">HEC Finance Academy</text>
                    </svg>
                </div>
                <h2>üéì BYS Academy</h2>
                <p>Connexion √† votre compte</p>
                <div class="error-message" id="loginError"></div>
                <form id="loginForm">
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="loginEmail" required>
                    </div>
                    <div class="form-group">
                        <label>Mot de passe</label>
                        <input type="password" id="loginPassword" required>
                    </div>
                    <button type="submit" class="btn-primary" id="loginBtn">Se connecter</button>
                </form>
                <div class="divider">
                    <span>OU</span>
                </div>
                <button class="btn-guest" id="guestBtn">üë§ Continuer en tant qu'invit√©</button>
                <div class="auth-link">
                    Pas encore de compte ? <a id="goToRegister">S'inscrire</a>
                </div>
            </div>
        </div>

        <div id="register" class="page">
            <div class="auth-container">
                <div style="display: flex; justify-content: center; align-items: center; gap: 1.5rem; margin-bottom: 1.5rem;">
                    <svg style="height: 70px; width: auto;" viewBox="0 0 200 280" xmlns="http://www.w3.org/2000/svg">
                        <rect fill="#1e3a8a" width="200" height="280"/>
                        <g transform="translate(100, 90)">
                            <rect fill="#ffffff" x="-3" y="0" width="6" height="75" rx="1.5"/>
                            <path fill="none" stroke="#ffffff" stroke-width="2.5" d="M -3,15 Q -18,25 -14,40 Q -10,50 -3,58"/>
                            <path fill="none" stroke="#ffffff" stroke-width="2.5" d="M 3,15 Q 18,25 14,40 Q 10,50 3,58"/>
                            <circle fill="#ffffff" cx="-14" cy="20" r="2"/>
                            <circle fill="#ffffff" cx="14" cy="20" r="2"/>
                            <path fill="#ffffff" d="M -3,-8 Q -28,-15 -32,-8 Q -35,-2 -30,3 Q -25,6 -3,2 Z"/>
                            <path fill="#ffffff" d="M 3,-8 Q 28,-15 32,-8 Q 35,-2 30,3 Q 25,6 3,2 Z"/>
                        </g>
                        <ellipse cx="100" cy="130" rx="48" ry="52" fill="none" stroke="#ffffff" stroke-width="2.5"/>
                        <text fill="#ffffff" x="100" y="210" font-family="serif" font-size="38" font-weight="bold" text-anchor="middle">IHEC</text>
                        <text fill="#ffffff" x="100" y="238" font-family="serif" font-size="16" text-anchor="middle" letter-spacing="6">CARTHAGE</text>
                    </svg>
                    
                    <svg style="height: 70px; width: auto;" viewBox="0 0 220 220" xmlns="http://www.w3.org/2000/svg">
                        <g transform="translate(110, 65)">
                            <ellipse fill="#ffd700" cx="0" cy="18" rx="32" ry="22"/>
                            <ellipse fill="#ffd700" cx="0" cy="-3" rx="18" ry="16"/>
                            <path fill="#ffd700" d="M -14,-14 Q -23,-22 -19,-26 Q -17,-24 -14,-18 Z"/>
                            <path fill="#ffd700" d="M 14,-14 Q 23,-22 19,-26 Q 17,-24 14,-18 Z"/>
                            <rect fill="#ffd700" x="-22" y="32" width="7" height="18" rx="2"/>
                            <rect fill="#ffd700" x="-7" y="32" width="7" height="18" rx="2"/>
                            <rect fill="#ffd700" x="0" y="32" width="7" height="18" rx="2"/>
                            <rect fill="#ffd700" x="15" y="32" width="7" height="18" rx="2"/>
                            <circle cx="-7" cy="-3" r="1.8" fill="#1e40af"/>
                            <circle cx="7" cy="-3" r="1.8" fill="#1e40af"/>
                        </g>
                        <g transform="translate(110, 108)">
                            <ellipse fill="#1e40af" cx="0" cy="2" rx="26" ry="16" opacity="0.75"/>
                            <circle fill="#1e40af" cx="0" cy="-12" r="13" opacity="0.75"/>
                        </g>
                        <text x="110" y="165" font-family="'Arial Black', sans-serif" font-size="36" font-weight="900" text-anchor="middle">
                            <tspan fill="#1e40af">HEC'</tspan><tspan fill="#ffd700">FA</tspan>
                        </text>
                        <text fill="#1e40af" x="110" y="185" font-family="Arial" font-size="12" text-anchor="middle" letter-spacing="1.5">HEC Finance Academy</text>
                    </svg>
                </div>
                <h2>üéì BYS Academy</h2>
                <p>Cr√©er votre compte</p>
                <div class="error-message" id="registerError"></div>
                <form id="registerForm">
                    <div class="form-group">
                        <label>Nom complet</label>
                        <input type="text" id="registerName" required placeholder="Ahmed Ben Salem">
                    </div>
                    <div class="form-group">
                        <label>Email IHEC</label>
                        <input type="email" id="registerEmail" required placeholder="prenom.nom.2024@ihec.ucar.tn">
                        <small style="color: #666; font-size: 0.85rem; display: block; margin-top: 0.3rem;">
                            ‚ö†Ô∏è Utilisez uniquement votre email IHEC
                        </small>
                    </div>
                    <div class="form-group">
                        <label>Mot de passe</label>
                        <input type="password" id="registerPassword" required minlength="6" placeholder="Minimum 6 caract√®res">
                    </div>
                    <button type="submit" class="btn-primary" id="registerBtn">S'inscrire</button>
                </form>
                <div class="auth-link">
                    D√©j√† un compte ? <a id="goToLogin">Se connecter</a>
                </div>
            </div>
        </div>

        <div id="home" class="page">
            <div class="hero">
                <h1>üéâ Bienvenue √† BYS Academy</h1>
                <p><strong>Boost Your Skills - Let's build together!</strong></p>
                <p style="color: #666; max-width: 800px; margin: 1rem auto 0;">
                    Un centre de formation interactif pour d√©velopper vos comp√©tences entrepreneuriales et professionnelles.
                </p>
            </div>
            
            <!-- Progress Tracker -->
            <div class="progress-tracker" id="progressSection" style="display: none;">
                <h2 style="color: var(--ihec-blue); margin-bottom: 1rem;">üìä Votre Progression</h2>
                <div class="progress-bar-container">
                    <div class="progress-bar-fill" id="progressBar" style="width: 0%"></div>
                </div>
                <p style="text-align: center; color: #666; margin-top: 0.5rem;">
                    <span id="progressText">0% compl√©t√©</span>
                </p>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="coursesCompleted">0</div>
                        <div class="stat-label">Cours termin√©s</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalHours">0h</div>
                        <div class="stat-label">Heures d'√©tude</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="quizScore">0</div>
                        <div class="stat-label">Score Quiz</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="currentStreak">0</div>
                        <div class="stat-label">Jours cons√©cutifs</div>
                    </div>
                </div>
            </div>
            
            <div class="features">
                <div class="feature-card">
                    <h3>üíª Formations Hybrides</h3>
                    <p>Formations en pr√©sentiel ou en ligne selon vos disponibilit√©s.</p>
                </div>
                <div class="feature-card">
                    <h3>üéì Certificats Officiels</h3>
                    <p>Obtenez un certificat pour valoriser vos comp√©tences.</p>
                </div>
                <div class="feature-card">
                    <h3>ü§ù Plateforme Interactive</h3>
                    <p>√âchangez avec des experts et d'autres √©tudiants.</p>
                </div>
                <div class="feature-card">
                    <h3>üèÜ Gamification</h3>
                    <p>Gagnez des badges et suivez votre progression.</p>
                </div>
                <div class="feature-card">
                    <h3>‚è±Ô∏è Suivi du Temps</h3>
                    <p>Chronom√®tre d'√©tude avec m√©thode Pomodoro.</p>
                </div>
                <div class="feature-card">
                    <h3>üìà Classement</h3>
                    <p>Comparez vos performances avec les autres √©tudiants.</p>
                </div>
            </div>
        </div>

        <div id="formations" class="page">
            <div class="card">
                <h2>üìö Nos Formations</h2>
                <p>D√©veloppez vos comp√©tences avec nos formations certifiantes</p>
            </div>
            <div class="loading" id="formationsLoading">Chargement des formations...</div>
            <div class="formations-grid" id="formationsGrid"></div>
        </div>

        <div id="formation-details" class="page">
            <div class="card">
                <div id="formation-details-content"></div>
            </div>
        </div>

        <div id="learning-interface" class="page">
            <div class="learning-interface">
                <div class="course-sidebar">
                    <h2 id="course-title" style="margin-bottom: 2rem;"></h2>
                    <div id="course-modules"></div>
                </div>
                <div class="course-content">
                    <div class="video-container">
                        <div id="video-placeholder" style="color: white;">
                            Contenu vid√©o sera affich√© ici
                        </div>
                    </div>
                    <div class="learning-tabs">
                        <div class="learning-tab active" onclick="switchLearningTab('description')">Description</div>
                        <div class="learning-tab" onclick="switchLearningTab('discussions')">Discussions</div>
                        <div class="learning-tab" onclick="switchLearningTab('notes')">Mes Notes</div>
                    </div>
                    <div id="tab-content"></div>
                </div>
            </div>
        </div>

        <div id="requetes" class="page">
            <div class="card" style="max-width: 700px; margin: 0 auto;">
                <h2>üìù Soumettre une Requ√™te</h2>
                <div class="success-message" id="requeteSuccess"></div>
                <form id="requeteForm">
                    <div class="form-group">
                        <label>Type de requ√™te</label>
                        <select id="requestType" required>
                            <option value="">-- S√©lectionnez --</option>
                            <option value="technique">Probl√®me technique</option>
                            <option value="formation">Question sur une formation</option>
                            <option value="certificat">Demande de certificat</option>
                            <option value="autre">Autre</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Sujet</label>
                        <input type="text" id="requestSubject" required>
                    </div>
                    <div class="form-group">
                        <label>Message</label>
                        <textarea id="requestMessage" required style="min-height: 150px;"></textarea>
                    </div>
                    <button type="submit" class="btn-primary">Envoyer</button>
                </form>
                <h3 style="margin-top: 2rem;">Mes requ√™tes</h3>
                <div id="requetesList"></div>
            </div>
        </div>
        
        <!-- Page Badges & Gamification -->
        <!-- Page Profil -->
        <div id="profil" class="page">
            <div class="card">
                <h2>üë§ Mon Profil</h2>
                
                <!-- Informations personnelles -->
                <div class="profile-section">
                    <h3>üìã Informations Personnelles</h3>
                    <div class="profile-info">
                        <div class="info-item">
                            <strong>Nom :</strong>
                            <span id="profileName">-</span>
                        </div>
                        <div class="info-item">
                            <strong>Email :</strong>
                            <span id="profileEmail">-</span>
                        </div>
                        <div class="info-item">
                            <strong>Centre d'int√©r√™t :</strong>
                            <span id="profileInterest">-</span>
                        </div>
                        <div class="info-item">
                            <strong>Membre depuis :</strong>
                            <span id="profileJoinDate">-</span>
                        </div>
                    </div>
                </div>

                <!-- Progression -->
                <div class="profile-section">
                    <h3>üìä Ma Progression</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="profileCoursesCompleted">0</div>
                            <div class="stat-label">Cours compl√©t√©s</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="profileStudyHours">0</div>
                            <div class="stat-label">Heures d'√©tude</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="profileQuizScore">0%</div>
                            <div class="stat-label">Moy. Quiz</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="profileStreak">0</div>
                            <div class="stat-label">Jours de suite</div>
                        </div>
                    </div>
                </div>

                <!-- Badges -->
                <div class="profile-section">
                    <h3>üèÜ Mes Badges</h3>
                    <div class="badges-container">
                        <div class="badge">
                            <div class="badge-icon">üéØ</div>
                            <div class="badge-title">Premier Pas</div>
                            <small>S'inscrire √† une formation</small>
                        </div>
                        <div class="badge locked">
                            <div class="badge-icon">üìö</div>
                            <div class="badge-title">√âtudiant Assidu</div>
                            <small>Terminer 3 formations</small>
                        </div>
                        <div class="badge locked">
                            <div class="badge-icon">üí°</div>
                            <div class="badge-title">G√©nie</div>
                            <small>Score parfait √† un quiz</small>
                        </div>
                        <div class="badge locked">
                            <div class="badge-icon">üî•</div>
                            <div class="badge-title">En Feu</div>
                            <small>7 jours cons√©cutifs</small>
                        </div>
                        <div class="badge locked">
                            <div class="badge-icon">‚≠ê</div>
                            <div class="badge-title">Superstar</div>
                            <small>Top 10 du classement</small>
                        </div>
                        <div class="badge locked">
                            <div class="badge-icon">üëë</div>
                            <div class="badge-title">Champion</div>
                            <small>Top 1 du classement</small>
                        </div>
                        <div class="badge locked">
                            <div class="badge-icon">üéì</div>
                            <div class="badge-title">Dipl√¥m√©</div>
                            <small>Obtenir 5 certificats</small>
                        </div>
                        <div class="badge locked">
                            <div class="badge-icon">üí¨</div>
                            <div class="badge-title">Communicateur</div>
                            <small>50 messages post√©s</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Page Admin -->
        <div id="admin" class="page">
            <div class="card">
                <h2>‚öôÔ∏è Tableau de Bord Admin</h2>
                <p style="color: #666; margin-bottom: 2rem;">Bienvenue dans l'interface administrateur</p>
                
                <div class="admin-section">
                    <h3>üìä Statistiques Globales</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="adminTotalUsers">0</div>
                            <div class="stat-label">Utilisateurs</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="adminTotalCourses">0</div>
                            <div class="stat-label">Formations</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="adminActiveUsers">0</div>
                            <div class="stat-label">Actifs ce mois</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="adminPendingRequests">0</div>
                            <div class="stat-label">Requ√™tes en attente</div>
                        </div>
                    </div>
                </div>

                <div class="admin-section">
                    <h3>üí¨ Requ√™tes R√©centes</h3>
                    <div id="adminRequestsList" class="requests-list">
                        <p style="color: #999; text-align: center;">Chargement...</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="badges" class="page">
            <div class="card">
                <h2>üèÜ Badges & R√©alisations</h2>
                <p style="color: #666; margin-bottom: 2rem;">D√©bloquez des badges en progressant dans vos formations !</p>
                <div class="badges-container">
                    <div class="badge">
                        <div class="badge-icon">üéØ</div>
                        <div class="badge-title">Premier Pas</div>
                        <small>S'inscrire √† une formation</small>
                    </div>
                    <div class="badge locked">
                        <div class="badge-icon">üìö</div>
                        <div class="badge-title">√âtudiant Assidu</div>
                        <small>Terminer 3 formations</small>
                    </div>
                    <div class="badge locked">
                        <div class="badge-icon">üí°</div>
                        <div class="badge-title">G√©nie</div>
                        <small>Score parfait √† un quiz</small>
                    </div>
                    <div class="badge locked">
                        <div class="badge-icon">üî•</div>
                        <div class="badge-title">En Feu</div>
                        <small>7 jours cons√©cutifs</small>
                    </div>
                    <div class="badge locked">
                        <div class="badge-icon">‚≠ê</div>
                        <div class="badge-title">Superstar</div>
                        <small>Top 10 du classement</small>
                    </div>
                    <div class="badge locked">
                        <div class="badge-icon">üëë</div>
                        <div class="badge-title">Champion</div>
                        <small>Top 1 du classement</small>
                    </div>
                    <div class="badge locked">
                        <div class="badge-icon">üéì</div>
                        <div class="badge-title">Dipl√¥m√©</div>
                        <small>Obtenir 5 certificats</small>
                    </div>
                    <div class="badge locked">
                        <div class="badge-icon">üí¨</div>
                        <div class="badge-title">Communicateur</div>
                        <small>50 messages post√©s</small>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Page Study Timer -->
        <div id="timer" class="page">
            <div class="container" style="max-width: 600px;">
                <div class="study-timer">
                    <h2>‚è±Ô∏è Chronom√®tre d'√âtude</h2>
                    <p style="opacity: 0.9;">M√©thode Pomodoro : 25 min de travail + 5 min de pause</p>
                    <div class="timer-display" id="timerDisplay">25:00</div>
                    <div class="timer-controls">
                        <button class="timer-btn" id="startTimer">‚ñ∂ D√©marrer</button>
                        <button class="timer-btn" id="pauseTimer">‚è∏ Pause</button>
                        <button class="timer-btn" id="resetTimer">‚Üª Reset</button>
                    </div>
                    <div style="margin-top: 2rem; padding-top: 2rem; border-top: 1px solid rgba(255,255,255,0.2);">
                        <p>Sessions aujourd'hui : <strong id="sessionsToday">0</strong></p>
                        <p>Temps total : <strong id="totalTime">0h 00min</strong></p>
                    </div>
                </div>
                
                <div class="card" style="margin-top: 2rem;">
                    <h3 style="color: var(--ihec-blue);">üìã Conseils de Productivit√©</h3>
                    <ul style="line-height: 2; color: #666;">
                        <li>‚úÖ √âliminez les distractions avant de commencer</li>
                        <li>‚úÖ Prenez des notes pendant les sessions</li>
                        <li>‚úÖ Faites des pauses r√©guli√®res</li>
                        <li>‚úÖ Hydratez-vous bien</li>
                        <li>‚úÖ R√©visez apr√®s chaque session</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- Page Leaderboard -->
        </div>
    </div>
    
    <!-- Footer -->
    <!-- Chat Widget -->
    <div class="chat-widget">
        <button class="chat-button" id="chatToggle" onclick="toggleChat()">üí¨</button>
        <div class="chat-box" id="chatBox">
            <div class="chat-header">
                <span>üí¨ Support & Requ√™tes</span>
            </div>
            <div class="chat-messages" id="chatMessages">
                <div class="chat-message admin">
                    <strong>Admin</strong>
                    <p>Bonjour ! Comment puis-je vous aider ?</p>
                </div>
            </div>
            <div class="chat-input-area">
                <input type="text" class="chat-input" id="chatInput" placeholder="Votre message..." onkeypress="if(event.key==='Enter') sendChatMessage()">
                <button class="chat-send-btn" onclick="sendChatMessage()">üì§</button>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>üéì BYS Academy</h3>
                <p>Boost Your Skills - Let's build together!</p>
                <p style="margin-top: 1rem;">Plateforme de formation d√©di√©e aux √©tudiants de l'IHEC Carthage et HEC Finance Academy.</p>
                <!-- Logos dans le footer -->
                <div style="display: flex; gap: 1rem; margin-top: 1.5rem; align-items: center;">
                    <img src="images/logo_ihec.png" alt="IHEC Carthage" style="height: 60px; width: auto;">
                    <img src="images/logo_hecfa.png" alt="HEC'FA" style="height: 60px; width: auto;">
                </div>
            </div>
            
            <div class="footer-section">
                <h3>üìö Menu</h3>
                <a href="#" onclick="showPage('home'); return false;">Accueil</a>
                <a href="#" onclick="showPage('formations'); return false;">Formations</a>
                <a href="#" onclick="showPage('profil'); return false;">Profil</a>
            </div>
            
            <div class="footer-section">
                <h3>üîó Liens Utiles</h3>
                <a href="#" onclick="openModal('reglement'); return false;">R√®glement Int√©rieur</a>
                <a href="#" onclick="openModal('cgv'); return false;">Conditions G√©n√©rales</a>
                <a href="#" onclick="openModal('confidentialite'); return false;">Politique de Confidentialit√©</a>
                <a href="#" onclick="showPage('requetes'); return false;">Contact & Support</a>
            </div>
            
            <div class="footer-section">
                <h3>üì± R√©seaux Sociaux</h3>
                <p>Suivez-nous sur nos r√©seaux</p>
                <div class="social-links">
                    <a href="https://facebook.com" target="_blank" title="Facebook">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                        </svg>
                    </a>
                    <a href="https://instagram.com" target="_blank" title="Instagram">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                        </svg>
                    </a>
                    <a href="https://linkedin.com" target="_blank" title="LinkedIn">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                        </svg>
                    </a>
                    <a href="https://twitter.com" target="_blank" title="Twitter/X">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                        </svg>
                    </a>
                    <a href="https://youtube.com" target="_blank" title="YouTube">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                        </svg>
                    </a>
                </div>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>&copy; 2025 BYS Academy - IHEC Carthage & HEC Finance Academy. Tous droits r√©serv√©s.</p>
            <p style="margin-top: 0.5rem; font-size: 0.9rem;">D√©velopp√© avec ‚ù§Ô∏è pour les √©tudiants</p>
        </div>
    </footer>
    
    <!-- Modal pour r√®glement et autres -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal()">&times;</span>
            <div id="modalBody"></div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, addDoc, getDocs, doc, setDoc, getDoc, updateDoc, query, orderBy, limit, increment, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        
        // Make Firestore functions available globally
        window.doc = doc;
        window.getDoc = getDoc;
        window.collection = collection;
        window.addDoc = addDoc;
        window.getDocs = getDocs;
        window.setDoc = setDoc;
        window.updateDoc = updateDoc;
        window.query = query;
        window.orderBy = orderBy;
        window.limit = limit;
        window.increment = increment;
        window.serverTimestamp = serverTimestamp;

        const firebaseConfig = {
            apiKey: "AIzaSyAyeE0WeboL_GFxj4styCJ-28S-F5KIvAQ",
            authDomain: "bysa-b50d4.firebaseapp.com",
            projectId: "bysa-b50d4",
            storageBucket: "bysa-b50d4.firebasestorage.app",
            messagingSenderId: "1045933897411",
            appId: "1:1045933897411:web:1b54c6cf1056a6426fd476"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let currentUser = null;
        let userData = null;
        let currentFormation = null;
        let currentModule = null;
        let isGuestMode = false;

        function showPage(page) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(page).classList.add('active');
        }

        function showError(id, msg) {
            const el = document.getElementById(id);
            el.textContent = msg;
            el.style.display = 'block';
            setTimeout(() => el.style.display = 'none', 5000);
        }

        function showSuccess(id, msg) {
            const el = document.getElementById(id);
            el.textContent = msg;
            el.style.display = 'block';
            setTimeout(() => el.style.display = 'none', 3000);
        }

        // Menu hamburger toggle
        const menuToggle = document.getElementById('menuToggle');
        const navLinks = document.getElementById('navLinks');
        
        menuToggle.addEventListener('click', () => {
            navLinks.classList.toggle('mobile-open');
            menuToggle.classList.toggle('active');
        });

        // Fermer le menu lors du clic sur un lien
        document.querySelectorAll('.nav-links a').forEach(link => {
            link.addEventListener('click', () => {
                navLinks.classList.remove('mobile-open');
                menuToggle.classList.remove('active');
            });
        });

        // Fermer le menu lors du clic en dehors
        document.addEventListener('click', (e) => {
            if (!menuToggle.contains(e.target) && !navLinks.contains(e.target)) {
                navLinks.classList.remove('mobile-open');
                menuToggle.classList.remove('active');
            }
        });

        function activateGuestMode() {
            isGuestMode = true;
            currentUser = { uid: 'guest', email: 'guest@bysa.local' };
            userData = { 
                name: 'Invit√©', 
                email: 'guest@bysa.local',
                role: 'guest',
                enrolledFormations: []
            };
            document.getElementById('username').textContent = 'üë§ Invit√©';
            document.getElementById('navbar').classList.add('show');
            showPage('home');
            loadFormations();
        }

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                currentUser = user;
                isGuestMode = false;
                try {
                    const userDoc = await getDoc(doc(db, 'users', user.uid));
                    if (userDoc.exists()) {
                        userData = userDoc.data();
                        document.getElementById('username').textContent = 'üë§ ' + (userData.name || user.email);
                        document.getElementById('navbar').classList.add('show');
                        showPage('home');
                        loadFormations();
                        checkAdmin(); // V√©rifier si admin
                    } else {
                        console.error('Document utilisateur non trouv√©');
                        await signOut(auth);
                    }
                } catch (err) {
                    console.error('Erreur lors de la r√©cup√©ration des donn√©es:', err);
                    await signOut(auth);
                }
            } else {
                if (!isGuestMode) {
                    currentUser = null;
                    userData = null;
                    document.getElementById('navbar').classList.remove('show');
                    // V√©rifier si l'utilisateur a d√©j√† fait le sondage
                    if (localStorage.getItem('surveyCompleted')) {
                        showPage('landing');
                    } else {
                        showPage('survey');
                    }
                }
            }
        });

        document.getElementById('registerForm').onsubmit = async (e) => {
            e.preventDefault();
            const btn = document.getElementById('registerBtn');
            const email = document.getElementById('registerEmail').value;
            
            // Validation stricte de l'email IHEC
            const emailRegex = /^[a-zA-Z]+\.[a-zA-Z]+\.\d{4}@ihec\.ucar\.tn$/;
            
            if (!emailRegex.test(email)) {
                showError('registerError', '‚ùå Email invalide ! Format requis : prenom.nom.ann√©e@ihec.ucar.tn (exemple : ahmed.ben.2024@ihec.ucar.tn)');
                return;
            }
            
            btn.disabled = true;
            btn.textContent = 'Cr√©ation en cours...';
            
            try {
                const cred = await createUserWithEmailAndPassword(
                    auth,
                    email,
                    document.getElementById('registerPassword').value
                );
                await setDoc(doc(db, 'users', cred.user.uid), {
                    name: document.getElementById('registerName').value,
                    email: cred.user.email,
                    role: 'student',
                    createdAt: serverTimestamp(),
                    enrolledFormations: []
                });
            } catch (err) {
                let errorMsg = 'Erreur lors de l\'inscription';
                if (err.code === 'auth/email-already-in-use') {
                    errorMsg = '‚ùå Ce compte existe d√©j√†';
                } else if (err.code === 'auth/weak-password') {
                    errorMsg = '‚ùå Mot de passe trop faible (minimum 6 caract√®res)';
                }
                showError('registerError', errorMsg);
                btn.disabled = false;
                btn.textContent = 'S\'inscrire';
            }
        };

        document.getElementById('loginForm').onsubmit = async (e) => {
            e.preventDefault();
            const btn = document.getElementById('loginBtn');
            btn.disabled = true;
            try {
                await signInWithEmailAndPassword(
                    auth,
                    document.getElementById('loginEmail').value,
                    document.getElementById('loginPassword').value
                );
            } catch (err) {
                showError('loginError', 'Email ou mot de passe incorrect');
                btn.disabled = false;
            }
        };

        document.getElementById('logoutBtn').onclick = () => {
            if (isGuestMode) {
                isGuestMode = false;
                currentUser = null;
                userData = null;
                document.getElementById('navbar').classList.remove('show');
                showPage('login');
            } else {
                signOut(auth);
            }
        };
        
        document.getElementById('guestBtn').onclick = () => activateGuestMode();
        document.getElementById('goToRegister').onclick = () => showPage('register');
        document.getElementById('goToLogin').onclick = () => showPage('login');
        document.getElementById('navHome').onclick = () => showPage('home');
        document.getElementById('navFormations').onclick = () => { showPage('formations'); loadFormations(); };
        document.getElementById('navProfil').onclick = () => { 
            showPage('profil'); 
            loadProfileData(); 
        };
        
        // Fonction pour le sondage
        window.selectInterest = function(interest) {
            localStorage.setItem('userInterest', interest);
            localStorage.setItem('surveyCompleted', 'true');
            if (userData) {
                userData.interest = interest;
                // Sauvegarder dans Firebase si connect√©
                if (currentUser && !isGuestMode) {
                    setDoc(doc(db, 'users', currentUser.uid), { interest }, { merge: true });
                }
            }
            showPage('landing');
        }

        // Fonction toggle chat
        window.toggleChat = function() {
            const chatBox = document.getElementById('chatBox');
            chatBox.classList.toggle('open');
        }

        // Fonction envoyer message chat
        window.sendChatMessage = async function() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            if (isGuestMode) {
                alert('üîí Veuillez vous connecter pour envoyer des messages.');
                return;
            }
            
            // Ajouter le message √† l'interface
            const messagesDiv = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'chat-message';
            messageDiv.innerHTML = `<strong>Vous</strong><p>${message}</p>`;
            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
            
            // Sauvegarder dans Firebase
            try {
                await addDoc(collection(db, 'chat_messages'), {
                    userId: currentUser.uid,
                    userName: userData.name || 'Utilisateur',
                    message: message,
                    timestamp: serverTimestamp(),
                    status: 'pending'
                });
            } catch (err) {
                console.error('Erreur envoi message:', err);
            }
            
            input.value = '';
        }

        // Charger les donn√©es du profil
        window.loadProfileData = async function() {
            if (!currentUser) return;
            
            document.getElementById('profileName').textContent = userData?.name || '-';
            document.getElementById('profileEmail').textContent = userData?.email || '-';
            document.getElementById('profileInterest').textContent = userData?.interest || localStorage.getItem('userInterest') || '-';
            document.getElementById('profileJoinDate').textContent = userData?.createdAt ? new Date(userData.createdAt.seconds * 1000).toLocaleDateString('fr-FR') : '-';
            
            // Stats (valeurs par d√©faut pour l'instant)
            document.getElementById('profileCoursesCompleted').textContent = userData?.coursesCompleted || '0';
            document.getElementById('profileStudyHours').textContent = userData?.studyHours || '0';
            document.getElementById('profileQuizScore').textContent = (userData?.quizScore || 0) + '%';
            document.getElementById('profileStreak').textContent = userData?.streak || '0';
        }

        // V√©rifier si admin
        function checkAdmin() {
            if (currentUser && currentUser.email === 'klaioff118@gmail.com') {
                // Ajouter un lien admin dans le menu utilisateur
                const userInfo = document.querySelector('.user-info');
                if (userInfo && !document.getElementById('adminLink')) {
                    const adminBtn = document.createElement('button');
                    adminBtn.id = 'adminLink';
                    adminBtn.className = 'btn-logout';
                    adminBtn.textContent = '‚öôÔ∏è Admin';
                    adminBtn.style.background = '#ff6b6b';
                    adminBtn.style.marginRight = '0.5rem';
                    adminBtn.onclick = () => {
                        showPage('admin');
                        loadAdminData();
                    };
                    userInfo.insertBefore(adminBtn, userInfo.firstChild);
                }
            }
        }

        // Charger donn√©es admin
        window.loadAdminData = async function() {
            try {
                // Total users
                const usersSnap = await getDocs(collection(db, 'users'));
                document.getElementById('adminTotalUsers').textContent = usersSnap.size;
                
                // Total courses
                const coursesSnap = await getDocs(collection(db, 'formations'));
                document.getElementById('adminTotalCourses').textContent = coursesSnap.size;
                
                // Active users (simulation)
                document.getElementById('adminActiveUsers').textContent = Math.floor(usersSnap.size * 0.7);
                
                // Pending requests
                const requestsSnap = await getDocs(query(collection(db, 'chat_messages'), orderBy('timestamp', 'desc'), limit(10)));
                document.getElementById('adminPendingRequests').textContent = requestsSnap.size;
                
                // Liste des requ√™tes
                const requestsList = document.getElementById('adminRequestsList');
                requestsList.innerHTML = '';
                
                if (requestsSnap.empty) {
                    requestsList.innerHTML = '<p style="color: #999; text-align: center;">Aucune requ√™te pour le moment</p>';
                } else {
                    requestsSnap.forEach(doc => {
                        const req = doc.data();
                        const div = document.createElement('div');
                        div.className = 'request-item';
                        div.innerHTML = `
                            <strong>${req.userName}</strong>
                            <p style="margin: 0.5rem 0; color: #666;">${req.message}</p>
                            <small style="color: #999;">${req.timestamp ? new Date(req.timestamp.seconds * 1000).toLocaleString('fr-FR') : 'En attente'}</small>
                        `;
                        requestsList.appendChild(div);
                    });
                }
            } catch (err) {
                console.error('Erreur chargement admin:', err);
            }
        }
        
        // Modal functions
        window.openModal = function(type) {
            const modal = document.getElementById('modal');
            const body = document.getElementById('modalBody');
            
            let content = '';
            if (type === 'reglement') {
                content = `
                    <h2 style="color: var(--ihec-blue); margin-bottom: 1.5rem;">üìã R√®glement Int√©rieur</h2>
                    <div style="line-height: 1.8; color: #333;">
                        <h3>Article 1 : Inscription</h3>
                        <p>L'inscription √† BYS Academy est r√©serv√©e aux √©tudiants de l'IHEC Carthage et HEC Finance Academy avec une adresse email institutionnelle valide.</p>
                        
                        <h3>Article 2 : Comportement</h3>
                        <p>Les √©tudiants doivent faire preuve de respect envers les formateurs et les autres participants. Tout comportement inappropri√© entra√Ænera une exclusion imm√©diate.</p>
                        
                        <h3>Article 3 : Assiduit√©</h3>
                        <p>Une pr√©sence r√©guli√®re est requise pour obtenir le certificat. Un taux d'absent√©isme sup√©rieur √† 20% entra√Æne l'annulation de la certification.</p>
                        
                        <h3>Article 4 : Propri√©t√© Intellectuelle</h3>
                        <p>Tout le contenu des formations est prot√©g√© par des droits d'auteur. La reproduction ou le partage non autoris√© est strictement interdit.</p>
                        
                        <h3>Article 5 : √âvaluations</h3>
                        <p>Les √©tudiants doivent r√©aliser les quiz et √©valuations en toute honn√™tet√©. Toute tricherie sera sanctionn√©e.</p>
                        
                        <h3>Article 6 : Certificats</h3>
                        <p>Les certificats sont d√©livr√©s uniquement aux √©tudiants ayant compl√©t√© au moins 80% du programme et valid√© les √©valuations.</p>
                    </div>
                `;
            } else if (type === 'cgv') {
                content = `
                    <h2 style="color: var(--ihec-blue); margin-bottom: 1.5rem;">üìú Conditions G√©n√©rales d'Utilisation</h2>
                    <div style="line-height: 1.8; color: #333;">
                        <h3>1. Acceptation des conditions</h3>
                        <p>En acc√©dant √† BYS Academy, vous acceptez les pr√©sentes conditions g√©n√©rales d'utilisation.</p>
                        
                        <h3>2. Acc√®s au service</h3>
                        <p>L'acc√®s √† la plateforme est gratuit pour les √©tudiants inscrits. Nous nous r√©servons le droit de modifier ou d'interrompre le service √† tout moment.</p>
                        
                        <h3>3. Compte utilisateur</h3>
                        <p>Vous √™tes responsable de la confidentialit√© de vos identifiants. Toute activit√© effectu√©e sous votre compte est de votre responsabilit√©.</p>
                        
                        <h3>4. Contenu utilisateur</h3>
                        <p>Vous conservez vos droits sur le contenu que vous publiez, mais accordez √† BYS Academy une licence d'utilisation.</p>
                        
                        <h3>5. Limitation de responsabilit√©</h3>
                        <p>BYS Academy ne peut √™tre tenu responsable des dommages directs ou indirects r√©sultant de l'utilisation de la plateforme.</p>
                    </div>
                `;
            } else if (type === 'confidentialite') {
                content = `
                    <h2 style="color: var(--ihec-blue); margin-bottom: 1.5rem;">üîí Politique de Confidentialit√©</h2>
                    <div style="line-height: 1.8; color: #333;">
                        <h3>1. Collecte des donn√©es</h3>
                        <p>Nous collectons uniquement les informations n√©cessaires au fonctionnement de la plateforme : nom, email, progression dans les formations.</p>
                        
                        <h3>2. Utilisation des donn√©es</h3>
                        <p>Vos donn√©es sont utilis√©es pour :</p>
                        <ul>
                            <li>G√©rer votre compte et votre progression</li>
                            <li>Vous envoyer des notifications importantes</li>
                            <li>Am√©liorer nos services</li>
                        </ul>
                        
                        <h3>3. Protection des donn√©es</h3>
                        <p>Nous utilisons Firebase pour stocker vos donn√©es de mani√®re s√©curis√©e. Vos informations sont prot√©g√©es par des mesures de s√©curit√© robustes.</p>
                        
                        <h3>4. Partage des donn√©es</h3>
                        <p>Nous ne vendons ni ne partageons vos donn√©es personnelles avec des tiers, sauf obligation l√©gale.</p>
                        
                        <h3>5. Vos droits</h3>
                        <p>Vous avez le droit d'acc√©der, de modifier ou de supprimer vos donn√©es personnelles √† tout moment.</p>
                        
                        <h3>6. Cookies</h3>
                        <p>Nous utilisons des cookies pour am√©liorer votre exp√©rience utilisateur et analyser l'utilisation de la plateforme.</p>
                    </div>
                `;
            }
            
            body.innerHTML = content;
            modal.classList.add('active');
        };
        
        window.closeModal = function() {
            document.getElementById('modal').classList.remove('active');
        };
        
        // Study Timer Logic
        let timerInterval = null;
        let timeLeft = 25 * 60; // 25 minutes in seconds
        let sessionsCount = 0;
        let totalStudyTime = 0;
        let isRunning = false;
        
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            document.getElementById('timerDisplay').textContent = 
                `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }
        
        document.getElementById('startTimer').onclick = function() {
            if (!isRunning) {
                isRunning = true;
                timerInterval = setInterval(() => {
                    if (timeLeft > 0) {
                        timeLeft--;
                        updateTimerDisplay();
                    } else {
                        clearInterval(timerInterval);
                        isRunning = false;
                        sessionsCount++;
                        totalStudyTime += 25;
                        document.getElementById('sessionsToday').textContent = sessionsCount;
                        document.getElementById('totalTime').textContent = 
                            `${Math.floor(totalStudyTime / 60)}h ${totalStudyTime % 60}min`;
                        alert('üéâ Session termin√©e ! Prenez une pause de 5 minutes.');
                        timeLeft = 25 * 60;
                        updateTimerDisplay();
                    }
                }, 1000);
            }
        };
        
        document.getElementById('pauseTimer').onclick = function() {
            if (isRunning) {
                clearInterval(timerInterval);
                isRunning = false;
            }
        };
        
        document.getElementById('resetTimer').onclick = function() {
            clearInterval(timerInterval);
            isRunning = false;
            timeLeft = 25 * 60;
            updateTimerDisplay();
        };
        
        // Update progress on home page for logged-in users
        function updateProgress() {
            if (!isGuestMode && userData) {
                document.getElementById('progressSection').style.display = 'block';
                const progress = userData.enrolledFormations ? 
                    (userData.enrolledFormations.length * 20) : 0;
                document.getElementById('progressBar').style.width = Math.min(progress, 100) + '%';
                document.getElementById('progressText').textContent = Math.min(progress, 100) + '% compl√©t√©';
                document.getElementById('coursesCompleted').textContent = userData.enrolledFormations?.length || 0;
            }
        }
        
        // Call updateProgress when showing home page
        const originalShowPage = showPage;
        showPage = function(page) {
            originalShowPage(page);
            if (page === 'home') {
                updateProgress();
            }
        };

        async function loadFormations() {
            const grid = document.getElementById('formationsGrid');
            const loading = document.getElementById('formationsLoading');
            try {
                const snap = await getDocs(collection(db, 'formations'));
                grid.innerHTML = '';
                snap.forEach(d => {
                    const f = d.data();
                    const isEnrolled = userData.enrolledFormations?.includes(d.id);
                    grid.innerHTML += `
                        <div class="formation-card">
                            <div class="formation-body">
                                <h3>${f.title}</h3>
                                <p style="color: #666; font-size: 0.9rem;">
                                    ${f.duration} ‚Ä¢ ${f.format} ‚Ä¢ ${f.instructor}
                                </p>
                                <p>${f.description}</p>
                                <p style="color: #999; font-size: 0.9rem; margin-top: 1rem;">
                                    ${f.enrolled || 0}/${f.capacity} inscrits
                                </p>
                                <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                                    <button class="btn-secondary" onclick="showFormationDetails('${d.id}')">
                                        Voir les d√©tails
                                    </button>
                                    <button class="btn-secondary" 
                                        onclick="enrollFormation('${d.id}')"
                                        style="${isEnrolled ? 'background: #4caf50;' : ''}">
                                        ${isEnrolled ? 'Acc√©der au cours ‚ûú' : 'S\'inscrire'}
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                });
                loading.style.display = 'none';
            } catch (err) {
                loading.textContent = 'Erreur de chargement';
            }
        }

        window.showFormationDetails = async (id) => {
            const detailsDiv = document.getElementById('formation-details-content');
            try {
                const docRef = doc(db, 'formations', id);
                const docSnap = await getDoc(docRef);
                if (docSnap.exists()) {
                    const f = docSnap.data();
                    const isEnrolled = userData.enrolledFormations?.includes(id);
                    
                    detailsDiv.innerHTML = `
                        <h2>${f.title}</h2>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin: 1rem 0;">
                            <p style="color: #666; font-size: 1.1rem;">
                                ${f.duration} ‚Ä¢ ${f.format}
                            </p>
                            <button class="btn-secondary" 
                                onclick="enrollFormation('${id}')"
                                ${isEnrolled ? 'disabled' : ''}
                                style="${isEnrolled ? 'background: #4caf50;' : ''}">
                                ${isEnrolled ? 'Inscrit ‚úì' : 'S\'inscrire'}
                            </button>
                        </div>
                        
                        <div style="margin: 2rem 0;">
                            <h3 style="margin-bottom: 1rem;">üìã Description du cours</h3>
                            <p>${f.description}</p>
                        </div>

                        <div style="margin: 2rem 0;">
                            <h3 style="margin-bottom: 1rem;">üë®‚Äçüè´ Formateur</h3>
                            <p>${f.instructor}</p>
                        </div>

                        <div style="margin: 2rem 0;">
                            <h3 style="margin-bottom: 1rem;">üìö Programme d√©taill√©</h3>
                            ${f.program ? `<ul style="list-style-type: none; padding: 0;">
                                ${f.program.map(item => `
                                    <li style="margin-bottom: 1rem; padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                                        ${item}
                                    </li>
                                `).join('')}
                            </ul>` : '<p>Programme en cours de pr√©paration...</p>'}
                        </div>

                        <div style="margin: 2rem 0;">
                            <h3>üë• Participants</h3>
                            <p>${f.enrolled || 0}/${f.capacity} places occup√©es</p>
                            <div style="background: #f8f9fa; border-radius: 8px; padding: 1rem; margin-top: 1rem;">
                                <div style="width: ${((f.enrolled || 0) / f.capacity) * 100}%; height: 10px; background: #667eea; border-radius: 5px;"></div>
                            </div>
                        </div>
                    `;
                    showPage('formation-details');
                }
            } catch (err) {
                console.error('Erreur chargement d√©tails:', err);
                alert('Erreur lors du chargement des d√©tails');
            }
        };

        window.loadReplies = function(discussionId) {
            return getDocs(
                query(
                    collection(db, 'formations', currentFormation, 'discussions', discussionId, 'replies'),
                    orderBy('timestamp', 'asc')
                )
            ).then(repliesSnap => {
                let repliesHtml = '';
                repliesSnap.forEach(r => {
                    const reply = r.data();
                    const date = reply.timestamp?.toDate().toLocaleString('fr-FR') || '√Ä l\'instant';
                    repliesHtml += `
                        <div class="discussion-item" style="margin-top: 0.5rem;" data-reply="${r.id}">
                            <div class="discussion-header">
                                <span class="discussion-author">${reply.authorName}</span>
                                <span class="discussion-date">${date}</span>
                            </div>
                            <div>${reply.content}</div>
                            <div class="discussion-actions">
                                <div class="action-btn" onclick="likeModuleReply('${discussionId}', '${r.id}')">
                                    <span>üëç</span>
                                    <span class="likes-count">${reply.likes || 0}</span>
                                </div>
                            </div>
                        </div>
                    `;
                });
                return repliesHtml;
            }).catch(err => {
                console.error('Erreur chargement r√©ponses:', err);
                return '';
            });
        };

        window.likeModuleReply = async (discussionId, replyId) => {
            if (!currentUser) return;
            try {
                const ref = doc(db, 'formations', currentFormation, 'discussions', discussionId, 'replies', replyId);
                const docSnap = await getDoc(ref);
                
                if (!docSnap.exists()) {
                    console.error('Reply not found');
                    return;
                }

                const reply = docSnap.data();
                const likedBy = reply.likedBy || [];
                const hasLiked = likedBy.includes(currentUser.uid);

                if (hasLiked) {
                    // Retirer le like
                    await updateDoc(ref, {
                        likes: increment(-1),
                        likedBy: likedBy.filter(uid => uid !== currentUser.uid)
                    });
                } else {
                    // Ajouter le like
                    await updateDoc(ref, {
                        likes: increment(1),
                        likedBy: [...likedBy, currentUser.uid]
                    });
                }

                const newDoc = await getDoc(ref);
                const replyElement = document.querySelector(`#replies-${discussionId} [data-reply="${replyId}"]`);
                if (replyElement) {
                    const likeButton = replyElement.querySelector('.like-btn');
                    const likeCount = replyElement.querySelector('.likes-count');
                    
                    likeCount.textContent = newDoc.data().likes || 0;
                    
                    // Mettre √† jour le style selon l'√©tat
                    if (!hasLiked) {
                        likeButton.style.color = '#667eea';
                        likeButton.style.fontWeight = 'bold';
                    } else {
                        likeButton.style.color = '';
                        likeButton.style.fontWeight = '';
                    }
                }
            } catch (err) {
                console.error('Erreur like:', err);
                alert('Erreur lors du like');
            }
        }

        window.startLearning = async (formationId) => {
            currentFormation = formationId;
            const formationDoc = await getDoc(doc(db, 'formations', formationId));
            if (!formationDoc.exists()) return;
            
            const formation = formationDoc.data();
            document.getElementById('course-title').textContent = formation.title;
            
            const modulesHtml = formation.modules?.map((module, index) => `
                <div class="module-item ${index === 0 ? 'active' : ''}" onclick="switchModule(${index})">
                    <div>
                        <div>${module.title}</div>
                        <div class="duration">${module.duration}</div>
                    </div>
                </div>
            `).join('') || 'Aucun module disponible';
            
            document.getElementById('course-modules').innerHTML = modulesHtml;
            document.getElementById('tab-content').innerHTML = `
                <h3>Description du module</h3>
                <p>${formation.modules?.[0]?.description || 'Aucune description disponible'}</p>
            `;
            
            showPage('learning-interface');
        };

        window.switchModule = (index) => {
            currentModule = index;
            document.querySelectorAll('.module-item').forEach((item, i) => {
                item.classList.toggle('active', i === index);
            });
            
            // Update content based on selected module
            // This would be expanded based on your content structure
            document.getElementById('video-placeholder').textContent = 
                `Contenu du module ${index + 1}`;
        };

        window.switchLearningTab = async (tab) => {
            document.querySelectorAll('.learning-tab').forEach(t => {
                t.classList.toggle('active', t.textContent.toLowerCase().includes(tab));
            });
            
            const contentDiv = document.getElementById('tab-content');
            contentDiv.innerHTML = '<div class="loading">Chargement...</div>';
            
            switch(tab) {
                case 'description':
                    try {
                        const docRef = window.doc(db, 'formations', currentFormation);
                        const docSnap = await window.getDoc(docRef);
                        const formation = docSnap.data();
                        contentDiv.innerHTML = `
                            <h3>Description du module</h3>
                            <p>${formation.modules?.[currentModule]?.description || 'Aucune description disponible'}</p>
                        `;
                    } catch (err) {
                        console.error('Error loading description:', err);
                        contentDiv.innerHTML = '<div class="error-message">Erreur lors du chargement de la description</div>';
                    }
                    break;
                    
                case 'discussions':
                    try {
                        const discussions = await getDocs(
                            query(
                                collection(db, 'formations', currentFormation, 'discussions'),
                                orderBy('timestamp', 'desc')
                            )
                        );

                        // Create the base discussion HTML structure
                        contentDiv.innerHTML = `
                            <div class="form-group">
                                <textarea id="newModuleDiscussion" placeholder="Poser une question..."
                                    style="min-height: 100px;"></textarea>
                            </div>
                            <button class="btn-primary" onclick="postModuleDiscussion()">Publier</button>
                            <div id="discussions-list" style="margin-top: 2rem;"></div>
                        `;

                        const discussionsList = document.getElementById('discussions-list');
                        discussions.forEach(d => {
                            const disc = d.data();
                            const date = disc.timestamp?.toDate().toLocaleString('fr-FR') || '√Ä l\'instant';
                            const discussionHtml = `
                                <div class="discussion-item" id="disc-${d.id}">
                                    <div class="discussion-header">
                                        <span class="discussion-author">${disc.authorName}</span>
                                        <span class="discussion-date">${date}</span>
                                    </div>
                                    <div>${disc.content}</div>
                                    <div class="discussion-actions">
                                        <div class="action-btn ${(disc.likedBy || []).includes(currentUser.uid) ? 'liked' : ''}" 
                                             onclick="likeModuleDiscussion('${d.id}')"
                                             style="color: ${(disc.likedBy || []).includes(currentUser.uid) ? '#667eea' : 'inherit'}; 
                                                    font-weight: ${(disc.likedBy || []).includes(currentUser.uid) ? 'bold' : 'normal'}">
                                            <span class="like-btn">üëç</span>
                                            <span class="likes-count">${disc.likes || 0}</span>
                                        </div>
                                        <div class="action-btn" onclick="showModuleReplyForm('${d.id}')">
                                            <span>üí¨ R√©pondre</span>
                                        </div>
                                    </div>
                                    <div class="replies-container" id="replies-${d.id}"></div>
                                </div>
                            `;
                            discussionsList.insertAdjacentHTML('beforeend', discussionHtml);

                            // Load replies for this discussion
                            loadReplies(d.id).then(repliesHtml => {
                                const repliesContainer = document.getElementById(`replies-${d.id}`);
                                if (repliesContainer) {
                                    repliesContainer.innerHTML = repliesHtml;
                                }
                            }).catch(err => {
                                console.error('Error loading replies:', err);
                            });
                        });
                    } catch (err) {
                        console.error('Error loading discussions:', err);
                        contentDiv.innerHTML = '<div class="error-message">Erreur lors du chargement des discussions</div>';
                    }
                    break;
                    break;
                    
                case 'notes':
                    contentDiv.innerHTML = `
                        <div class="form-group">
                            <textarea id="moduleNotes" placeholder="Prenez vos notes ici..."
                                style="min-height: 300px;"></textarea>
                        </div>
                        <button class="btn-primary" onclick="saveNotes()">Enregistrer</button>
                    `;
                    // Load saved notes if they exist
                    try {
                        const notesRef = window.doc(db, 'users', currentUser.uid, 'notes', currentFormation);
                        const notesSnap = await window.getDoc(notesRef);
                        if (notesSnap.exists()) {
                            document.getElementById('moduleNotes').value = notesSnap.data().content;
                        }
                    } catch (err) {
                        console.error('Erreur chargement notes:', err);
                        contentDiv.innerHTML += '<div class="error-message">Erreur lors du chargement des notes</div>';
                    }
                    break;
            }
        };

        window.postModuleDiscussion = async () => {
            const content = document.getElementById('newModuleDiscussion').value.trim();
            if (!content || !currentUser || !userData) return;
            
            if (isGuestMode) {
                alert('üîí Les invit√©s ne peuvent pas publier de discussions.\n\nInscrivez-vous pour participer aux discussions !');
                return;
            }
            
            try {
                await addDoc(collection(db, 'formations', currentFormation, 'discussions'), {
                    authorId: currentUser.uid,
                    authorName: userData.name || currentUser.email,
                    content: content,
                    timestamp: serverTimestamp(),
                    likes: 0
                });
                document.getElementById('newModuleDiscussion').value = '';
                switchLearningTab('discussions');
            } catch (err) {
                console.error('Erreur publication:', err);
                alert('Erreur lors de la publication');
            }
        };

        window.showModuleReplyForm = (discussionId) => {
            const repliesDiv = document.getElementById(`replies-${discussionId}`);
            repliesDiv.innerHTML += `
                <div class="form-group" style="margin-top: 1rem;">
                    <textarea id="reply-${discussionId}" placeholder="Votre r√©ponse..."
                        style="min-height: 100px;"></textarea>
                    <button class="btn-secondary" onclick="postModuleReply('${discussionId}')"
                        style="margin-top: 0.5rem;">R√©pondre</button>
                </div>
            `;
        };

        window.postModuleReply = async (discussionId) => {
            const content = document.getElementById(`reply-${discussionId}`).value.trim();
            if (!content || !currentUser || !userData) return;
            
            if (isGuestMode) {
                alert('üîí Les invit√©s ne peuvent pas r√©pondre aux discussions.\n\nInscrivez-vous pour participer !');
                return;
            }
            
            try {
                await addDoc(
                    collection(db, 'formations', currentFormation, 'discussions', discussionId, 'replies'),
                    {
                        authorId: currentUser.uid,
                        authorName: userData.name || currentUser.email,
                        content: content,
                        timestamp: serverTimestamp(),
                        likes: 0
                    }
                );
                switchLearningTab('discussions');
            } catch (err) {
                console.error('Erreur r√©ponse:', err);
                alert('Erreur lors de la publication de la r√©ponse');
            }
        };

        window.likeModuleDiscussion = async (discussionId) => {
            if (!currentUser) return;
            
            if (isGuestMode) {
                alert('üîí Les invit√©s ne peuvent pas liker.\n\nInscrivez-vous pour interagir !');
                return;
            }
            
            try {
                const ref = doc(db, 'formations', currentFormation, 'discussions', discussionId);
                const docSnap = await getDoc(ref);
                
                if (!docSnap.exists()) {
                    console.error('Discussion not found');
                    return;
                }

                const discussion = docSnap.data();
                const likedBy = discussion.likedBy || [];

                if (likedBy.includes(currentUser.uid)) {
                    alert('Vous avez d√©j√† lik√© ce message');
                    return;
                }

                await updateDoc(ref, {
                    likes: increment(1),
                    likedBy: [...likedBy, currentUser.uid]
                });

                const newDoc = await getDoc(ref);
                const likeButton = document.querySelector(`#disc-${discussionId} .like-btn`);
                const likeCount = document.querySelector(`#disc-${discussionId} .likes-count`);
                
                likeCount.textContent = newDoc.data().likes || 0;
                likeButton.style.color = '#667eea';
                likeButton.style.fontWeight = 'bold';
            } catch (err) {
                console.error('Erreur like:', err);
                alert('Erreur lors du like');
            }
        };

        window.saveNotes = async () => {
            if (!currentUser) return;
            try {
                await setDoc(
                    doc(db, 'users', currentUser.uid, 'notes', currentFormation),
                    {
                        content: document.getElementById('moduleNotes').value,
                        updatedAt: serverTimestamp()
                    }
                );
                alert('Notes enregistr√©es !');
            } catch (err) {
                console.error('Erreur enregistrement notes:', err);
                alert('Erreur lors de l\'enregistrement');
            }
        };

        window.enrollFormation = async (id) => {
            if (!currentUser || !userData) return;

            if (isGuestMode) {
                alert('üîí Les invit√©s ne peuvent pas s\'inscrire aux formations.\n\nCr√©ez un compte pour acc√©der aux formations compl√®tes !');
                showPage('register');
                return;
            }

            // Check if user is already enrolled
            if (userData.enrolledFormations?.includes(id)) {
                startLearning(id);
                return;
            }

            try {
                // Get formation data first to check capacity
                const formationDoc = await getDoc(doc(db, 'formations', id));
                if (!formationDoc.exists()) {
                    alert('Formation non trouv√©e');
                    return;
                }

                const formationData = formationDoc.data();
                if ((formationData.enrolled || 0) >= formationData.capacity) {
                    alert('D√©sol√©, cette formation est compl√®te');
                    return;
                }

                // Update formation enrolled count
                await updateDoc(doc(db, 'formations', id), {
                    enrolled: increment(1)
                });

                // Update user's enrolled formations
                const updatedFormations = [...(userData.enrolledFormations || []), id];
                await updateDoc(doc(db, 'users', currentUser.uid), {
                    enrolledFormations: updatedFormations
                });

                // Update local user data
                userData.enrolledFormations = updatedFormations;

                alert('Inscription r√©ussie !');
                
                // Refresh both formations list and details if open
                loadFormations();
                if (document.getElementById('formation-details').classList.contains('active')) {
                    showFormationDetails(id);
                }
            } catch (err) {
                console.error('Erreur inscription:', err);
                alert('Erreur lors de l\'inscription');
            }
        };

        async function loadDiscussions() {
            const list = document.getElementById('discussionsList');
            const loading = document.getElementById('discussionsLoading');
            try {
                const q = query(collection(db, 'discussions'), orderBy('timestamp', 'desc'), limit(20));
                const snap = await getDocs(q);
                list.innerHTML = '';
                snap.forEach(d => {
                    const disc = d.data();
                    const date = disc.timestamp?.toDate().toLocaleString('fr-FR') || '√Ä l\'instant';
                    list.innerHTML += `
                        <div class="discussion-item" id="disc-${d.id}">
                            <div class="discussion-header">
                                <span class="discussion-author">${disc.authorName}</span>
                                <span class="discussion-date">${date}</span>
                            </div>
                            <div>${disc.content}</div>
                            <div class="discussion-actions">
                                <div class="action-btn ${(disc.likedBy || []).includes(currentUser.uid) ? 'liked' : ''}" 
                                     onclick="likeDiscussion('${d.id}')"
                                     style="color: ${(disc.likedBy || []).includes(currentUser.uid) ? '#667eea' : 'inherit'}; 
                                            font-weight: ${(disc.likedBy || []).includes(currentUser.uid) ? 'bold' : 'normal'}">
                                    <span class="like-btn">üëç</span>
                                    <span class="likes-count">${disc.likes || 0}</span>
                                </div>
                                <div class="action-btn" onclick="showReplyForm('${d.id}')">
                                    <span>üí¨ R√©pondre</span>
                                </div>
                            </div>
                            <div class="replies-container" id="replies-${d.id}"></div>
                        </div>
                    `;
                });

                loading.style.display = 'none';

                // Load replies after rendering discussions
                snap.forEach(d => {
                    loadReplies(d.id).then(repliesHtml => {
                        const repliesContainer = document.getElementById(`replies-${d.id}`);
                        if (repliesContainer) {
                            repliesContainer.innerHTML = repliesHtml;
                        }
                    });
                });
            } catch (err) {
                loading.textContent = 'Erreur de chargement';
            }
        }

        document.getElementById('postDiscussion').onclick = async () => {
            const content = document.getElementById('newDiscussion').value.trim();
            if (!content || !currentUser || !userData) return;
            
            if (isGuestMode) {
                alert('üîí Les invit√©s ne peuvent pas publier de discussions.\n\nInscrivez-vous pour participer aux discussions !');
                return;
            }
            
            try {
                await addDoc(collection(db, 'discussions'), {
                    authorId: currentUser.uid,
                    authorName: userData.name || currentUser.email,
                    content: content,
                    timestamp: serverTimestamp(),
                    likes: 0
                });
                document.getElementById('newDiscussion').value = '';
                loadDiscussions();
            } catch (err) {
                console.error('Erreur publication:', err);
                alert('Erreur lors de la publication');
            }
        };

        window.likeDiscussion = async (discussionId) => {
            if (!currentUser) return;
            
            if (isGuestMode) {
                alert('üîí Les invit√©s ne peuvent pas liker.\n\nInscrivez-vous pour interagir !');
                return;
            }
            
            try {
                const ref = doc(db, 'discussions', discussionId);
                const docSnap = await getDoc(ref);
                
                if (!docSnap.exists()) {
                    console.error('Discussion not found');
                    return;
                }

                const discussion = docSnap.data();
                const likedBy = discussion.likedBy || [];
                const hasLiked = likedBy.includes(currentUser.uid);

                if (hasLiked) {
                    // Retirer le like
                    await updateDoc(ref, {
                        likes: increment(-1),
                        likedBy: likedBy.filter(uid => uid !== currentUser.uid)
                    });
                } else {
                    // Ajouter le like
                    await updateDoc(ref, {
                        likes: increment(1),
                        likedBy: [...likedBy, currentUser.uid]
                    });
                }

                const newDoc = await getDoc(ref);
                const likeButton = document.querySelector(`#disc-${discussionId} .like-btn`);
                const likeCount = document.querySelector(`#disc-${discussionId} .likes-count`);
                
                likeCount.textContent = newDoc.data().likes || 0;
                
                // Mettre √† jour le style selon l'√©tat
                if (!hasLiked) {
                    likeButton.style.color = '#667eea';
                    likeButton.style.fontWeight = 'bold';
                } else {
                    likeButton.style.color = '';
                    likeButton.style.fontWeight = '';
                }
            } catch (err) {
                console.error('Erreur like:', err);
                alert('Erreur lors du like');
            }
        };

        window.showReplyForm = (discussionId) => {
            const repliesDiv = document.getElementById(`replies-${discussionId}`);
            repliesDiv.innerHTML += `
                <div class="form-group" style="margin-top: 1rem;">
                    <textarea id="reply-${discussionId}" placeholder="Votre r√©ponse..."
                        style="min-height: 100px;"></textarea>
                    <button class="btn-secondary" onclick="postReply('${discussionId}')"
                        style="margin-top: 0.5rem;">R√©pondre</button>
                </div>
            `;
        };

        window.postReply = async (discussionId) => {
            const content = document.getElementById(`reply-${discussionId}`).value.trim();
            if (!content || !currentUser || !userData) return;
            
            try {
                await addDoc(
                    collection(db, 'discussions', discussionId, 'replies'),
                    {
                        authorId: currentUser.uid,
                        authorName: userData.name || currentUser.email,
                        content: content,
                        timestamp: serverTimestamp(),
                        likes: 0
                    }
                );
                loadDiscussions(); // Reload all discussions to show the new reply
            } catch (err) {
                console.error('Erreur r√©ponse:', err);
                alert('Erreur lors de la publication de la r√©ponse');
            }
        };

        async function loadRequetes() {
            const list = document.getElementById('requetesList');
            try {
                const snap = await getDocs(query(collection(db, 'requetes'), orderBy('timestamp', 'desc')));
                list.innerHTML = '';
                snap.forEach(d => {
                    const r = d.data();
                    if (r.userId === currentUser.uid) {
                        const date = r.timestamp?.toDate().toLocaleString('fr-FR') || '√Ä l\'instant';
                        list.innerHTML += `
                            <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                                <strong>${r.subject}</strong>
                                <p style="color: #666; font-size: 0.9rem;">${date}</p>
                                <p style="margin-top: 0.5rem;">${r.message}</p>
                                <span style="display: inline-block; margin-top: 0.5rem; padding: 0.3rem 0.8rem; background: #fff3cd; border-radius: 15px; font-size: 0.85rem;">
                                    ${r.status || 'pending'}
                                </span>
                            </div>
                        `;
                    }
                });
            } catch (err) {
                console.error(err);
            }
        }

        document.getElementById('requeteForm').onsubmit = async (e) => {
            e.preventDefault();
            if (!currentUser || !userData) return;
            try {
                await addDoc(collection(db, 'requetes'), {
                    userId: currentUser.uid,
                    userName: userData.name || currentUser.email,
                    type: document.getElementById('requestType').value,
                    subject: document.getElementById('requestSubject').value,
                    message: document.getElementById('requestMessage').value,
                    status: 'pending',
                    timestamp: serverTimestamp()
                });
                showSuccess('requeteSuccess', 'Requ√™te envoy√©e avec succ√®s !');
                e.target.reset();
                loadRequetes();
            } catch (err) {
                console.error('Erreur envoi requ√™te:', err);
                alert('Erreur lors de l\'envoi');
            }
        };
    </script>
</body>
</html>